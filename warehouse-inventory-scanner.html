<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè≠ AI Warehouse Inventory Scanner - Barbrick Design</title>
    <meta name="description" content="AI-powered inventory scanner for computer recycling warehouses with auto-identification and valuation">
    
    <!-- TensorFlow.js for AI Vision -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.11.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd@2.2.3"></script>
    
    <!-- ZXing for Barcode/QR Scanning -->
    <script src="https://cdn.jsdelivr.net/npm/@zxing/library@0.20.0/umd/index.min.js"></script>
    
    <!-- Enhanced Hardware Identification and eBay Pricing -->
    <script src="js/hardware-identification.js"></script>
    <script src="js/ebay-pricing-api.js"></script>
    
    <!-- Leaflet.js for Interactive Maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" 
          crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    
    <link rel="stylesheet" href="css/warehouse-scanner.css">
    <link rel="stylesheet" href="/css/universal-styles.css">
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header>
            <div class="brand">
                <div class="brand-mark">
                    <div class="brand-mark-inner">üè≠</div>
                </div>
                <div>
                    <div class="brand-text-title">AI Warehouse Scanner</div>
                    <div class="brand-text-sub">Computer Recycling</div>
                </div>
            </div>
            <div class="header-actions">
                <button id="toggleMode" class="icon-btn" title="Toggle Mode">üì∏</button>
                <button id="settingsBtn" class="icon-btn" title="Settings">‚öôÔ∏è</button>
            </div>
        </header>

        <!-- Main Content -->
        <main id="mainContent">
            <!-- Camera View -->
            <section id="cameraSection" class="camera-section">
                <div class="camera-container">
                    <video id="cameraVideo" autoplay playsinline></video>
                    <canvas id="overlayCanvas"></canvas>
                    
                    <!-- Scanning Overlay -->
                    <div class="scan-overlay">
                        <div class="scan-frame">
                            <button id="centerPlayBtn" class="center-play-btn" title="Start Scanning" aria-label="Start Scanning">
                                <span class="play-icon" aria-hidden="true">‚ñ∂Ô∏è</span>
                            </button>
                        </div>
                        <div class="scan-info">
                            <div id="scanStatus">Ready to scan</div>
                            <div id="detectionInfo"></div>
                        </div>
                    </div>
                    
                    <!-- AI Helper -->
                    <div id="aiHelper" class="ai-helper hidden">
                        <div class="ai-helper-avatar">ü§ñ</div>
                        <div class="ai-helper-message"></div>
                    </div>
                </div>

                <!-- Camera Controls -->
                <div class="camera-controls">
                    <button id="startScanBtn" class="btn-primary">
                        <span>‚ñ∂Ô∏è Start Scanning</span>
                    </button>
                    <button id="captureBtn" class="btn-secondary hidden">
                        <span>üì∏ Capture Item</span>
                    </button>
                    <button id="stopScanBtn" class="btn-danger hidden">
                        <span>‚èπÔ∏è Stop</span>
                    </button>
                </div>

                <!-- Quick Stats -->
                <div class="quick-stats">
                    <div class="stat-card">
                        <div class="stat-label">Scanned</div>
                        <div class="stat-value" id="scannedCount">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total Value</div>
                        <div class="stat-value" id="totalValue">$0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Session</div>
                        <div class="stat-value" id="sessionTime">00:00</div>
                    </div>
                </div>
                
                <!-- Color Legend -->
                <div class="detection-legend">
                    <div class="legend-title">Detection Status:</div>
                    <div class="legend-items">
                        <div class="legend-item">
                            <span class="legend-box purple-box"></span>
                            <span>Already Scanned</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-box green-box"></span>
                            <span>New (High Confidence)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-box orange-box"></span>
                            <span>New (Medium)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-box red-box"></span>
                            <span>New (Low)</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Inventory View -->
            <section id="inventorySection" class="inventory-section hidden">
                <!-- Warehouse Map -->
                <div class="warehouse-map">
                    <h3>üìç Interactive Warehouse Map</h3>
                    <div id="warehouseMap" style="height: 400px; border-radius: 8px; overflow: hidden;"></div>
                    <div class="map-legend">
                        <span class="legend-item"><span class="dot user-marker">üìç</span> Your Location</span>
                        <span class="legend-item"><span class="dot high-value">üíé</span> High Value ($1000+)</span>
                        <span class="legend-item"><span class="dot medium-value">‚≠ê</span> Medium Value ($500+)</span>
                        <span class="legend-item"><span class="dot standard">üì¶</span> Standard</span>
                    </div>
                </div>

                <!-- Inventory List -->
                <div class="inventory-list">
                    <div class="list-header">
                        <h3>üì¶ Inventory Items</h3>
                        <div class="list-controls">
                            <input type="text" id="searchInventory" placeholder="Search items..." />
                            <select id="filterCategory">
                                <option value="">All Categories</option>
                                <option value="computer">Computers</option>
                                <option value="printer">Printers</option>
                                <option value="monitor">Monitors</option>
                                <option value="electronics">Other Electronics</option>
                            </select>
                            <select id="sortBy">
                                <option value="time">Recently Added</option>
                                <option value="value-desc">Highest Value</option>
                                <option value="value-asc">Lowest Value</option>
                                <option value="location">Location</option>
                            </select>
                        </div>
                    </div>
                    <div id="inventoryItems" class="inventory-items"></div>
                </div>

                <!-- Value Analysis -->
                <div class="value-analysis">
                    <h3>üí∞ Value Analysis</h3>
                    <div id="valueHeatmap" class="value-heatmap"></div>
                    <div class="top-items">
                        <h4>Top 5 Most Valuable Items</h4>
                        <div id="topValueItems"></div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-btn active" data-view="camera">
                <span class="nav-icon">üì∏</span>
                <span class="nav-label">Scan</span>
            </button>
            <button class="nav-btn" data-view="inventory">
                <span class="nav-icon">üì¶</span>
                <span class="nav-label">Inventory</span>
            </button>
            <button class="nav-btn" data-view="reports">
                <span class="nav-icon">üìä</span>
                <span class="nav-label">Reports</span>
            </button>
            <button class="nav-btn" data-view="settings">
                <span class="nav-icon">‚öôÔ∏è</span>
                <span class="nav-label">Settings</span>
            </button>
        </nav>
    </div>

    <!-- Modals -->
    <!-- Item Details Modal -->
    <div id="itemModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Item Details</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body" id="itemDetails"></div>
            <div class="modal-footer">
                <button id="editItemBtn" class="btn-secondary">Edit</button>
                <button id="deleteItemBtn" class="btn-danger">Delete</button>
                <button class="btn-primary close-modal">Close</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚öôÔ∏è Scanner Settings</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <h4 style="margin-bottom: 1rem; color: #2563eb;">ü§ñ Auto Features</h4>
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="autoCapture" checked>
                        <strong>Enable Auto-Capture</strong>
                        <div style="font-size: 0.875rem; color: #6b7280; margin-left: 1.5rem;">
                            Automatically capture items when detected with high confidence
                        </div>
                    </label>
                </div>
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="autoIdentify" checked>
                        <strong>Enable Auto-Identify</strong>
                        <div style="font-size: 0.875rem; color: #6b7280; margin-left: 1.5rem;">
                            Continuously identify items in real-time during scan
                        </div>
                    </label>
                </div>
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="autoValuation" checked>
                        <strong>Enable Auto-Valuation</strong>
                        <div style="font-size: 0.875rem; color: #6b7280; margin-left: 1.5rem;">
                            Automatically estimate value for detected items
                        </div>
                    </label>
                </div>
                <div class="setting-group">
                    <label>
                        Auto-Capture Confidence Threshold: <span id="confidenceThresholdValue">80</span>%
                        <input type="range" id="confidenceThreshold" min="60" max="95" value="80" step="5" style="width: 100%; margin-top: 0.5rem;">
                    </label>
                </div>
                
                <h4 style="margin: 1.5rem 0 1rem; color: #2563eb;">üéôÔ∏è Other Settings</h4>
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="voiceCommands" checked>
                        Enable Voice Commands
                    </label>
                </div>
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="aiHelper" checked>
                        Enable AI Helper
                    </label>
                </div>
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="offlineMode">
                        Offline Mode
                    </label>
                </div>
                
                <h4 style="margin: 1.5rem 0 1rem; color: #2563eb;">üìç Warehouse Settings</h4>
                <div class="setting-group">
                    <label>Warehouse ID:</label>
                    <input type="text" id="warehouseId" placeholder="e.g., WH-001">
                </div>
                <div class="setting-group">
                    <label>Default Location:</label>
                    <input type="text" id="defaultLocation" placeholder="e.g., A1">
                </div>
            </div>
            <div class="modal-footer">
                <button id="exportDataBtn" class="btn-secondary">Export Data</button>
                <button id="importDataBtn" class="btn-secondary">Import Data</button>
                <button class="btn-primary close-modal">Save</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="spinner"></div>
        <div class="loading-text">Loading AI models...</div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Scripts -->
    <script src="js/warehouse-inventory-db.js"></script>
    <script src="js/warehouse-valuation-engine.js"></script>
    
    <!-- Enhanced Object Identification -->
    <script src="js/enhanced-object-identifier.js"></script>
    
    <script src="js/warehouse-scanner-ai.js"></script>
    <script src="js/warehouse-ai-helper.js"></script>
    <script src="js/warehouse-scanner-ui.js"></script>
    
    <!-- PayPal Integration -->
    <script src="/src/utils/paypal-integration.js"></script>
    <!-- Mobile Enhanced JS -->
    <script src="/js/mobile-enhancer.js"></script>
    <!-- Self-Healing Script -->
    <script src="/self-healing.js"></script>
    <!-- Angel Investment Hub -->
    <script src="/src/utils/angel-investment-hub.js"></script>
    
    <script>
        // Initialize the warehouse scanner application
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üè≠ Warehouse Inventory Scanner initialized');
            WarehouseScannerUI.init();
        });
    </script>
    <script src="/js/universal-utilities.js"></script>

    <!-- Universal Navigation - Added by Project Fixer -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof BarbrickUniversal !== 'undefined') {
                // Only add navigation if not already present
                if (!document.querySelector('.universal-header')) {
                    BarbrickUniversal.createBackButton();
                }
                
                // Add footer if not present
                if (!document.querySelector('.universal-footer')) {
                    BarbrickUniversal.createFooter();
                }
            }
        });
    </script>
</body>
</html>
